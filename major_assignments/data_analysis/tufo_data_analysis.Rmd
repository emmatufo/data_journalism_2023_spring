---
title: "data_analysis"
author: "Emma Tufo"
date: "2022-04-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries and establish settings

```{r}
library(tidyverse)
library(janitor)
library(tidycensus)
library(ggthemes)
```


```{r}
md_foreclosure_data <- read_csv("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/Maryland_Notices_of_Intent_to_Foreclose_by_Zip_Code.csv")
```

data cleaning ideas
- finding census data that matches cities to zipcodes and joining it so we can have a city column
- see which month has the most foreclosures overall
- do outside research about that time of year
- find month with highest percentage of total foreclosures in 2022 because we have all the data

```{r}
md_foreclosure_data <- md_foreclosure_data %>% 
  rename(`February 2022` = `February 2020`)

md_foreclosure_data
  
```

Question 1: a.) Where are there more foreclosures? **We just thought of this follow up question, so we're adding it here** b.) Is it different based on pop? Why? 
This is newsworthy because it would give insight into locations that experience higher numbers of debt, allowing a conclusion to be made about the area’s economic state.
- it would help to have cities for this one to generalize the count

// WE HAVE TO SORT BY POP AHHHHH realized this at the end. Another tuesday step. All good.
**Here's an updated map! https://datawrapper.dwcdn.net/WgzrW/1/**
```{r}
md_foreclosure_data <- md_foreclosure_data %>% 
  group_by(Zip) %>% 
  mutate(zip_2022_total = `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022`) %>% 
  mutate(zip_overall_total = `July 2021` + `August 2021` + `September 2021` + `October 2021` + `November 2021` + `December 2021` + `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022` + `January 2023` + `February 2023` + `March 2023`) %>% 
  arrange(desc(zip_overall_total)) %>% 
  mutate(Zip = as.double(Zip)) 

md_place_lines <- read_csv("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/Maryland_Political_Boundaries_-_ZIP_Codes_-_11_Digit.csv") %>% 
  mutate(ZIPCODE1 = as.double(ZIPCODE1)) 

md_data_and_boundaries <- md_foreclosure_data %>% 
  left_join(md_place_lines, by=c("Zip"="ZIPCODE1"))

md_data_and_boundaries

write_csv(md_data_and_boundaries, "data/q1_md_data_and_boundaries.csv")
```

Question 2: When were there the fewest or most foreclosures? Why?
This would likely indicate a change due to COVID, but I’m not sure whether that change would add more foreclosures or fewer due to the rent extensions the government allowed in the early days of the pandemic.

**Derek question: we're having trouble making the data graphable because of the individual month data. Could you please give us some help Tuesday and shed some light on how we should approach it to make the line graph we want? We drew it so you can see what the vision is.**
```{r}

write_csv(md_data_and_boundaries, "data/md_data_and_boundaries.csv")

knitr::include_graphics("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/LOOK_AT_THIS_it_is_a_graph.png")

md_data_and_boundaries %>% 
  ggplot() +
  geom_line(aes(x=reorder(`1`, `2`, ..., `547`), weight = (Zip)))


```

Question 3: What are the income levels for the most and least foreclosed-upon areas and what does the distribution of that look like?
This would show us how the value of homes and the income of people purchasing them differs in different income brackets.

**answer**
- The area with the highest household income is Parkville according to the data, but we're skeptical of the numbers we're seeing. I think we're missing something. We're going to work with it anyway and we'll clean it up Tuesday.
- Least foreclosed upon have anywhere between no household income and 600. 600 what? We don't know either! This is a journey.
- Most foreclosed upon (Upper Marlboro) has 16 thousand and some, the second most has 19 thousand, and the highest income was 28 thousand and some, so there is something wrong with this picture. Mostly with whatever weird data we chose. But the most foreclosed upon has a lower household income and the least foreclosed upon also has a lower household income or none but we think that's because it's made of government property, airports, and schools.
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE) 

MD_household_income <- get_acs(geography = "zcta", state = "MD", variables = "B19001_001", year = 2019)  %>% 
  mutate(GEOID = as.double(GEOID))

md_data_and_boundaries%>% 
  left_join(MD_household_income, by=c("Zip"="GEOID")) %>% 
  mutate(zip_overall_total = `July 2021` + `August 2021` + `September 2021` + `October 2021` + `November 2021` + `December 2021` + `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022` + `January 2023` + `February 2023` + `March 2023`) %>% 
  group_by(Zip, ZIPNAME, zip_overall_total) %>% 
  summarize(Zip, ZIPNAME, estimate, zip_overall_total) %>% 
  arrange(desc(zip_overall_total))
```
**Per capita income for 20772 (the highest number of foreclosures in 2022) is $53,168 according to https://www.incomebyzipcode.com/maryland/20772**
There are a WHOLE lot of zipcodes without any foreclosure notices OR with just one for 2022, so in the next few iterations of this project we'll try to combine zipcode data for each city so we have larger numbers to work with and more accurate population data.



Question 4: What does the racial demographic data look like in the areas of interest?
This is newsworthy because it would give us hard data on any disparities that might exist while comparing the income levels, foreclosure rate, and predominant races being foreclosed on.
- we're having trouble calling from census data, it's showing up the same no matter which variable we use. Let's troubleshoot this in class, it should come together pretty quickly once we figure that part out.
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE) 

MD_demographic_data <- get_acs(geography = "zcta", state = "MD", variables = "B25006_001", year = 2019)  
glimpse(MD_demographic_data)

```

**according to this website (https://www.unitedstateszipcodes.org/20772/#:~:text=The%20people%20living%20in%20ZIP,than%20average%20number%20of%20families) the demographic data for 20772 is 79% Black and a high proportion of homeowners in their late 20s to early 40s.**

**we are not needing to do a ton of coding for this, let's find a time next week for the three of us to meet so we can discuss ways to deepen the level of coding we do and questions we ask.**

Question 5: How long were people living there before they were foreclosed on? 
I don’t know whether this data is provided but it would be interesting and would allow us to see the frequency of turnover. If we could compare the buying and selling frequency of highly foreclosed areas to that of infrequently foreclosed areas, it would add a new depth to our research. 
- census stuff!
  option 1: "B07001_017 Estimate!!Total:!!Same house 1 year ago: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 2: "B07001_033 Estimate!!Total:!!Moved within same county: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FO"
  Option 3: "B07001_049 Estimate!!Total:!!Moved from different county within same state: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 4: "B07001_065 Estimate!!Total:!!Moved from different state: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES" 
  Option 5: "B07001_081 Estimate!!Total:!!Moved from abroad: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR"
  Option 6: "B07003_001 Estimate!!Total: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY SEX FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 7: "B07201_001 Estimate!!Total: GEOGRAPHICAL MOBILITY IN THE PAST YEAR FOR CURRE
  Option 8: "B07413_001 Estimate!!Total living in area 1 year ago: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY TENURE FOR RESIDENCE 1 YEAR AGO IN THE UNITED STATES

We think the idea is to load that data and do some adding to find the number of people who've moved away from their houses in that time, but we're not sure how to approach that or whether that's a good idea. We'd love to talk to you in or after class on Tuesday to discuss ideas.
- we think we need to take another step into the data to access it but we can't figure it out but it will all work out :)
- Our last step for this project will be organizing it into more of a report, just want you to know we heard your feedback
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE)  

MD_mobility_data <- get_acs(geography = "zcta", state = "MD", variables = "B07413_001", year = 2019)  
```

```{r}
md_foreclosure_data <- read_csv("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/Maryland_Notices_of_Intent_to_Foreclose_by_Zip_Code.csv")
```

data cleaning ideas
- finding census data that matches cities to zipcodes and joining it so we can have a city column
- see which month has the most foreclosures overall
- do outside research about that time of year
- find month with highest percentage of total foreclosures in 2022 because we have all the data

```{r}
md_foreclosure_data <- md_foreclosure_data %>% 
  rename(`February 2022` = `February 2020`)

md_foreclosure_data
  
```

Question 1: a.) Where are there more foreclosures? **We just thought of this follow up question, so we're adding it here** b.) Is it different based on pop? Why? 
This is newsworthy because it would give insight into locations that experience higher numbers of debt, allowing a conclusion to be made about the area’s economic state.
- it would help to have cities for this one to generalize the count

// WE HAVE TO SORT BY POP AHHHHH realized this at the end. Another tuesday step. All good.
**Here's an updated map! https://datawrapper.dwcdn.net/WgzrW/1/**
```{r}
md_foreclosure_data <- md_foreclosure_data %>% 
  group_by(Zip) %>% 
  mutate(zip_2022_total = `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022`) %>% 
  mutate(zip_overall_total = `July 2021` + `August 2021` + `September 2021` + `October 2021` + `November 2021` + `December 2021` + `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022` + `January 2023` + `February 2023` + `March 2023`) %>% 
  arrange(desc(zip_overall_total)) %>% 
  mutate(Zip = as.double(Zip)) 

md_place_lines <- read_csv("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/Maryland_Political_Boundaries_-_ZIP_Codes_-_11_Digit.csv") %>% 
  mutate(ZIPCODE1 = as.double(ZIPCODE1)) 

md_data_and_boundaries <- md_foreclosure_data %>% 
  left_join(md_place_lines, by=c("Zip"="ZIPCODE1"))

md_data_and_boundaries

write_csv(md_data_and_boundaries, "data/q1_md_data_and_boundaries.csv")
```

Question 2: When were there the fewest or most foreclosures? Why?
This would likely indicate a change due to COVID, but I’m not sure whether that change would add more foreclosures or fewer due to the rent extensions the government allowed in the early days of the pandemic.

**Derek question: we're having trouble making the data graphable because of the individual month data. Could you please give us some help Tuesday and shed some light on how we should approach it to make the line graph we want? We drew it so you can see what the vision is.**
```{r}

write_csv(md_data_and_boundaries, "data/md_data_and_boundaries.csv")

knitr::include_graphics("~/Documents/data_journalism_2023_spring/major_assignments/data_analysis/data/LOOK_AT_THIS_it_is_a_graph.png")

md_data_and_boundaries %>% 
  ggplot() +
  geom_line(aes(x=reorder(`1`, `2`, ..., `547`), weight = (Zip)))


```

Question 3: What are the income levels for the most and least foreclosed-upon areas and what does the distribution of that look like?
This would show us how the value of homes and the income of people purchasing them differs in different income brackets.

**answer**
- The area with the highest household income is Parkville according to the data, but we're skeptical of the numbers we're seeing. I think we're missing something. We're going to work with it anyway and we'll clean it up Tuesday.
- Least foreclosed upon have anywhere between no household income and 600. 600 what? We don't know either! This is a journey.
- Most foreclosed upon (Upper Marlboro) has 16 thousand and some, the second most has 19 thousand, and the highest income was 28 thousand and some, so there is something wrong with this picture. Mostly with whatever weird data we chose. But the most foreclosed upon has a lower household income and the least foreclosed upon also has a lower household income or none but we think that's because it's made of government property, airports, and schools.
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE) 

MD_household_income <- get_acs(geography = "zcta", state = "MD", variables = "B19001_001", year = 2019)  %>% 
  mutate(GEOID = as.double(GEOID))

md_data_and_boundaries%>% 
  left_join(MD_household_income, by=c("Zip"="GEOID")) %>% 
  mutate(zip_overall_total = `July 2021` + `August 2021` + `September 2021` + `October 2021` + `November 2021` + `December 2021` + `January 2022` + `February 2022` + `March 2022` + `April 2022` + `May 2022` + `June 2022` + `July 2022` + `August 2022` + `September 2022` + `October 2022` + `November 2022` + `December 2022` + `January 2023` + `February 2023` + `March 2023`) %>% 
  group_by(Zip, ZIPNAME, zip_overall_total) %>% 
  summarize(Zip, ZIPNAME, estimate, zip_overall_total) %>% 
  arrange(desc(zip_overall_total))
```
**Per capita income for 20772 (the highest number of foreclosures in 2022) is $53,168 according to https://www.incomebyzipcode.com/maryland/20772**
There are a WHOLE lot of zipcodes without any foreclosure notices OR with just one for 2022, so in the next few iterations of this project we'll try to combine zipcode data for each city so we have larger numbers to work with and more accurate population data.



Question 4: What does the racial demographic data look like in the areas of interest?
This is newsworthy because it would give us hard data on any disparities that might exist while comparing the income levels, foreclosure rate, and predominant races being foreclosed on.
- we're having trouble calling from census data, it's showing up the same no matter which variable we use. Let's troubleshoot this in class, it should come together pretty quickly once we figure that part out.
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE) 

MD_demographic_data <- get_acs(geography = "zcta", state = "MD", variables = "B25006_001", year = 2019)  
glimpse(MD_demographic_data)

```

**according to this website (https://www.unitedstateszipcodes.org/20772/#:~:text=The%20people%20living%20in%20ZIP,than%20average%20number%20of%20families) the demographic data for 20772 is 79% Black and a high proportion of homeowners in their late 20s to early 40s.**

**we are not needing to do a ton of coding for this, let's find a time next week for the three of us to meet so we can discuss ways to deepen the level of coding we do and questions we ask.**

Question 5: How long were people living there before they were foreclosed on? 
I don’t know whether this data is provided but it would be interesting and would allow us to see the frequency of turnover. If we could compare the buying and selling frequency of highly foreclosed areas to that of infrequently foreclosed areas, it would add a new depth to our research. 
- census stuff!
  option 1: "B07001_017 Estimate!!Total:!!Same house 1 year ago: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 2: "B07001_033 Estimate!!Total:!!Moved within same county: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FO"
  Option 3: "B07001_049 Estimate!!Total:!!Moved from different county within same state: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 4: "B07001_065 Estimate!!Total:!!Moved from different state: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR CURRENT RESIDENCE IN THE UNITED STATES" 
  Option 5: "B07001_081 Estimate!!Total:!!Moved from abroad: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY AGE FOR"
  Option 6: "B07003_001 Estimate!!Total: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY SEX FOR CURRENT RESIDENCE IN THE UNITED STATES"
  Option 7: "B07201_001 Estimate!!Total: GEOGRAPHICAL MOBILITY IN THE PAST YEAR FOR CURRE
  Option 8: "B07413_001 Estimate!!Total living in area 1 year ago: GEOGRAPHICAL MOBILITY IN THE PAST YEAR BY TENURE FOR RESIDENCE 1 YEAR AGO IN THE UNITED STATES

We think the idea is to load that data and do some adding to find the number of people who've moved away from their houses in that time, but we're not sure how to approach that or whether that's a good idea. We'd love to talk to you in or after class on Tuesday to discuss ideas.
- we think we need to take another step into the data to access it but we can't figure it out but it will all work out :)
- Our last step for this project will be organizing it into more of a report, just want you to know we heard your feedback
```{r}
census_api_key("577bf4d5bf135998c07189afd7dc2e2d621240d6")
ACS5 <- load_variables(2021, "acs5", cache = TRUE)  

MD_mobility_data <- get_acs(geography = "zcta", state = "MD", variables = "B07413_001", year = 2019)  
```
